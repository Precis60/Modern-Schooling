<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendar - Modern Schooling</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="nav-container">
                <div class="nav-logo">
                    <a href="index.html"><h1>Modern Schooling</h1></a>
                </div>
                <div class="nav-right">
                    <div class="nav-dropdown">
                        <button class="nav-btn" onclick="toggleNavigation()">
                            Menu
                        </button>
                        <div class="nav-menu-dropdown" id="navMenu">
                            <a href="index.html" class="nav-item-dropdown">Home</a>
                            <a href="blog.html" class="nav-item-dropdown">Daily Blog</a>
                            <a href="about.html" class="nav-item-dropdown">About</a>
                            <a href="activities.html" class="nav-item-dropdown">Activities</a>
                            <a href="calendar.html" class="nav-item-dropdown">Calendar</a>
                            <div class="nav-item-dropdown submenu-item" onclick="toggleSubmenu(event)">
                                Settings
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-left: auto;">
                                    <path d="M9 18l6-6-6-6"></path>
                                </svg>
                                <div class="submenu-dropdown" id="settingsSubmenu">
                                    <a href="theme.html" class="submenu-item-link">Theme</a>
                                    <a href="#" class="submenu-item-link">Font Size</a>
                                    <a href="#" class="submenu-item-link">Language</a>
                                    <a href="notifications.html" class="submenu-item-link">Notifications</a>
                                    <a href="account.html" class="submenu-item-link">Account</a>
                                    <a href="#" class="submenu-item-link">Help</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="hamburger">
                        <span class="bar"></span>
                        <span class="bar"></span>
                        <span class="bar"></span>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <main>
        <section class="hero">
            <div class="hero-content">
                <h1>School Calendar</h1>
                <p class="hero-subtitle">Stay organized with your academic schedule</p>
            </div>
        </section>

        <section style="padding: 80px 0; background: var(--bg-secondary); transition: background-color 0.3s ease;">
            <div class="container">
                <div style="max-width: 1200px; margin: 0 auto;">
                    
                    <!-- Calendar Header -->
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; flex-wrap: wrap; gap: 1rem;">
                        <div style="display: flex; align-items: center; gap: 1rem;">
                            <button id="prevPeriod" style="background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 8px; padding: 0.5rem; cursor: pointer; color: var(--text-primary);">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M15 18l-6-6 6-6"></path>
                                </svg>
                            </button>
                            <h2 id="currentPeriod" style="color: var(--text-primary); margin: 0; font-size: 1.5rem; font-weight: 600;"></h2>
                            <button id="nextPeriod" style="background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 8px; padding: 0.5rem; cursor: pointer; color: var(--text-primary);">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M9 18l6-6-6-6"></path>
                                </svg>
                            </button>
                        </div>
                        
                        <!-- View Toggle Buttons -->
                        <div style="display: flex; align-items: center; gap: 0.5rem; background: var(--bg-tertiary); border-radius: 8px; padding: 0.25rem;">
                            <button id="dayView" class="view-btn" style="background: transparent; border: none; border-radius: 6px; padding: 0.5rem 1rem; cursor: pointer; color: var(--text-secondary); font-weight: 500; transition: all 0.2s ease;">Day</button>
                            <button id="threeDayView" class="view-btn" style="background: transparent; border: none; border-radius: 6px; padding: 0.5rem 1rem; cursor: pointer; color: var(--text-secondary); font-weight: 500; transition: all 0.2s ease;">3 Day</button>
                            <button id="weekView" class="view-btn" style="background: transparent; border: none; border-radius: 6px; padding: 0.5rem 1rem; cursor: pointer; color: var(--text-secondary); font-weight: 500; transition: all 0.2s ease;">Week</button>
                            <button id="monthView" class="view-btn" style="background: #3b82f6; color: white; border: none; border-radius: 6px; padding: 0.5rem 1rem; cursor: pointer; font-weight: 500; transition: all 0.2s ease;">Month</button>
                        </div>
                        
                        <div style="display: flex; gap: 1rem;">
                            <button id="addEventBtn" style="background: #10b981; color: white; border: none; border-radius: 8px; padding: 0.75rem 1.5rem; cursor: pointer; font-weight: 500; display: flex; align-items: center; gap: 0.5rem;">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="12" y1="5" x2="12" y2="19"></line>
                                    <line x1="5" y1="12" x2="19" y2="12"></line>
                                </svg>
                                Add Event
                            </button>
                            <button id="todayBtn" style="background: #3b82f6; color: white; border: none; border-radius: 8px; padding: 0.75rem 1.5rem; cursor: pointer; font-weight: 500;">Today</button>
                        </div>
                    </div>

                    <!-- Calendar Grid -->
                    <div id="calendarContainer" style="background: var(--bg-tertiary); border-radius: 12px; padding: 1.5rem; margin-bottom: 2rem; transition: background-color 0.3s ease;">
                        <!-- Days of Week Header -->
                        <div id="daysHeader" style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 1px; margin-bottom: 1rem;">
                            <div style="padding: 1rem; text-align: center; font-weight: 600; color: var(--text-secondary);">Sun</div>
                            <div style="padding: 1rem; text-align: center; font-weight: 600; color: var(--text-secondary);">Mon</div>
                            <div style="padding: 1rem; text-align: center; font-weight: 600; color: var(--text-secondary);">Tue</div>
                            <div style="padding: 1rem; text-align: center; font-weight: 600; color: var(--text-secondary);">Wed</div>
                            <div style="padding: 1rem; text-align: center; font-weight: 600; color: var(--text-secondary);">Thu</div>
                            <div style="padding: 1rem; text-align: center; font-weight: 600; color: var(--text-secondary);">Fri</div>
                            <div style="padding: 1rem; text-align: center; font-weight: 600; color: var(--text-secondary);">Sat</div>
                        </div>
                        
                        <!-- Calendar Days -->
                        <div id="calendarDays" style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 1px; background: var(--border-color);">
                            <!-- Days will be generated by JavaScript -->
                        </div>
                    </div>

                    <!-- Upcoming Events -->
                    <div style="background: var(--bg-tertiary); padding: 2rem; border-radius: 12px; margin-bottom: 2rem; transition: background-color 0.3s ease;">
                        <h3 style="color: var(--text-secondary); margin-bottom: 1.5rem; display: flex; align-items: center;">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 0.75rem; color: #ef4444;">
                                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                                <line x1="16" y1="2" x2="16" y2="6"></line>
                                <line x1="8" y1="2" x2="8" y2="6"></line>
                                <line x1="3" y1="10" x2="21" y2="10"></line>
                            </svg>
                            Upcoming Events
                        </h3>
                        <div id="upcomingEventsList" style="display: grid; gap: 1rem;">
                            <!-- Events will be populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Quick Stats -->
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem;">
                        <div style="background: var(--bg-tertiary); padding: 1.5rem; border-radius: 12px; text-align: center; transition: background-color 0.3s ease;">
                            <div style="font-size: 2rem; font-weight: 700; color: #10b981; margin-bottom: 0.5rem;">8</div>
                            <div style="color: var(--text-secondary); font-size: 14px;">Days Until Break</div>
                        </div>
                        <div style="background: var(--bg-tertiary); padding: 1.5rem; border-radius: 12px; text-align: center; transition: background-color 0.3s ease;">
                            <div style="font-size: 2rem; font-weight: 700; color: #3b82f6; margin-bottom: 0.5rem;">3</div>
                            <div style="color: var(--text-secondary); font-size: 14px;">Upcoming Tests</div>
                        </div>
                        <div style="background: var(--bg-tertiary); padding: 1.5rem; border-radius: 12px; text-align: center; transition: background-color 0.3s ease;">
                            <div style="font-size: 2rem; font-weight: 700; color: #f59e0b; margin-bottom: 0.5rem;">5</div>
                            <div style="color: var(--text-secondary); font-size: 14px;">School Events</div>
                        </div>
                        <div style="background: var(--bg-tertiary); padding: 1.5rem; border-radius: 12px; text-align: center; transition: background-color 0.3s ease;">
                            <div style="font-size: 2rem; font-weight: 700; color: #ef4444; margin-bottom: 0.5rem;">2</div>
                            <div style="color: var(--text-secondary); font-size: 14px;">Assignments Due</div>
                        </div>
                    </div>

                </div>
            </div>
        </section>
    </main>

    <!-- Add Event Modal -->
    <div id="eventModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 1000; backdrop-filter: blur(4px);">
        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: var(--bg-primary); border-radius: 16px; padding: 2rem; width: 90%; max-width: 500px; box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                <h3 style="margin: 0; color: var(--text-primary); font-size: 1.25rem; font-weight: 600;">Add New Event</h3>
                <button id="closeModal" style="background: none; border: none; cursor: pointer; color: var(--text-tertiary); padding: 0.5rem;">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            
            <form id="eventForm">
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-weight: 500;">Event Title</label>
                    <input type="text" id="eventTitle" required style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; background: var(--bg-secondary); color: var(--text-primary); font-size: 1rem;">
                </div>
                
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-weight: 500;">Date</label>
                    <input type="date" id="eventDate" required style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; background: var(--bg-secondary); color: var(--text-primary); font-size: 1rem;">
                </div>
                
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-weight: 500;">Time (Optional)</label>
                    <div style="display: flex; align-items: center; gap: 1rem;">
                        <!-- Clock Interface -->
                        <div style="position: relative; width: 140px; height: 140px; border: 3px solid var(--border-color); border-radius: 50%; background: var(--bg-secondary); cursor: pointer;" id="clockContainer">
                                <svg width="140" height="140" style="position: absolute; top: 0; left: 0;">
                                    <!-- Hour markers -->
                                    <g stroke="var(--text-tertiary)" stroke-width="2">
                                        <!-- 12 o'clock (longer) -->
                                        <line x1="70" y1="8" x2="70" y2="22" />
                                        <!-- 1 o'clock -->
                                        <line x1="100.3" y1="20.7" x2="95.3" y2="28.2" />
                                        <!-- 2 o'clock -->
                                        <line x1="119.3" y1="39.7" x2="111.8" y2="44.7" />
                                        <!-- 3 o'clock (longer) -->
                                        <line x1="132" y1="70" x2="118" y2="70" />
                                        <!-- 4 o'clock -->
                                        <line x1="119.3" y1="100.3" x2="111.8" y2="95.3" />
                                        <!-- 5 o'clock -->
                                        <line x1="100.3" y1="119.3" x2="95.3" y2="111.8" />
                                        <!-- 6 o'clock (longer) -->
                                        <line x1="70" y1="132" x2="70" y2="118" />
                                        <!-- 7 o'clock -->
                                        <line x1="39.7" y1="119.3" x2="44.7" y2="111.8" />
                                        <!-- 8 o'clock -->
                                        <line x1="20.7" y1="100.3" x2="28.2" y2="95.3" />
                                        <!-- 9 o'clock (longer) -->
                                        <line x1="8" y1="70" x2="22" y2="70" />
                                        <!-- 10 o'clock -->
                                        <line x1="20.7" y1="39.7" x2="28.2" y2="44.7" />
                                        <!-- 11 o'clock -->
                                        <line x1="39.7" y1="20.7" x2="44.7" y2="28.2" />
                                    </g>
                                    <!-- Single hand -->
                                    <line id="clockHand" x1="70" y1="70" x2="70" y2="40" stroke="#3b82f6" stroke-width="4" stroke-linecap="round" />
                                    <!-- Center dot -->
                                    <circle cx="70" cy="70" r="4" fill="var(--text-primary)" />
                                </svg>
                        </div>
                        
                        <!-- Digital display and controls -->
                        <div style="flex: 1;">
                            <div style="background: var(--bg-tertiary); padding: 1rem; border-radius: 8px; border: 1px solid var(--border-color);">
                                <div style="font-size: 1.5rem; font-weight: 600; color: var(--text-primary); text-align: center; margin-bottom: 0.5rem;" id="timeDisplay">12:00 PM</div>
                                <div style="display: flex; gap: 0.5rem; justify-content: center;">
                                    <button type="button" id="amPmBtn" style="background: #6366f1; color: white; border: none; border-radius: 4px; padding: 0.25rem 0.75rem; cursor: pointer; font-size: 12px;">AM</button>
                                    <button type="button" id="clearTimeBtn" style="background: var(--bg-secondary); color: var(--text-secondary); border: 1px solid var(--border-color); border-radius: 4px; padding: 0.25rem 0.75rem; cursor: pointer; font-size: 12px;">Clear</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <input type="hidden" id="eventTime" />
                </div>
                
                <div style="margin-bottom: 1rem;">
                    <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-weight: 500;">Description (Optional)</label>
                    <textarea id="eventDescription" rows="3" style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; background: var(--bg-secondary); color: var(--text-primary); font-size: 1rem; resize: vertical;"></textarea>
                </div>
                
                <div style="margin-bottom: 1.5rem;">
                    <label style="display: block; margin-bottom: 0.5rem; color: var(--text-secondary); font-weight: 500;">Category</label>
                    <select id="eventCategory" style="width: 100%; padding: 0.75rem; border: 1px solid var(--border-color); border-radius: 8px; background: var(--bg-secondary); color: var(--text-primary); font-size: 1rem;">
                        <option value="assignment">Assignment</option>
                        <option value="test">Test/Exam</option>
                        <option value="event">School Event</option>
                        <option value="personal">Personal</option>
                        <option value="other">Other</option>
                    </select>
                </div>

                <div style="margin-bottom: 1.5rem; display: flex; justify-content: space-between; align-items: center; gap: 1rem;">
                    <label style="display: flex; align-items: center; gap: 0.5rem; color: var(--text-secondary); font-weight: 500; font-size: 0.95rem;">
                        <input type="checkbox" id="eventCompleted" style="width: 16px; height: 16px;">
                        <span>Mark as completed</span>
                    </label>
                    <button type="button" id="deleteEventBtn" style="display: none; background: #ef4444; color: white; border: none; border-radius: 8px; padding: 0.5rem 1rem; cursor: pointer; font-weight: 500; font-size: 0.9rem;">
                        Delete event
                    </button>
                </div>
                
                <div style="display: flex; gap: 1rem; justify-content: flex-end;">
                    <button type="button" id="cancelEvent" style="background: var(--bg-tertiary); color: var(--text-secondary); border: 1px solid var(--border-color); border-radius: 8px; padding: 0.75rem 1.5rem; cursor: pointer; font-weight: 500;">Cancel</button>
                    <button type="submit" style="background: #10b981; color: white; border: none; border-radius: 8px; padding: 0.75rem 1.5rem; cursor: pointer; font-weight: 500;">Save</button>
                </div>
            </form>
        </div>
    </div>

    <footer style="background: var(--footer-bg); color: var(--footer-text); padding: 40px 0; text-align: center; transition: background-color 0.3s ease, color 0.3s ease;">
        <div class="container">
            <p style="margin: 0; opacity: 0.8;">&copy; 2024 Modern Schooling. All rights reserved.</p>
        </div>
    </footer>

    <script src="script.js"></script>
    <script>
        // Calendar functionality with event management
        let currentDate = new Date();
        let events = JSON.parse(localStorage.getItem('calendarEvents')) || [];
        let selectedDate = null;
        let editingEventId = null;
        let currentView = 'month'; // 'day', 'threeDay', 'week', 'month'
        
        // Category colors
        const categoryColors = {
            assignment: '#ef4444',
            test: '#f59e0b',
            event: '#3b82f6',
            personal: '#8b5cf6',
            other: '#10b981'
        };
        
        function saveEvents() {
            localStorage.setItem('calendarEvents', JSON.stringify(events));
        }
        
        function getEventsForDate(date) {
            const dateStr = date.toISOString().split('T')[0];
            return events.filter(event => event.date === dateStr);
        }
        
        function updatePeriodHeader() {
            const monthNames = ["January", "February", "March", "April", "May", "June",
                "July", "August", "September", "October", "November", "December"];
            const dayNames = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
            
            let headerText = '';
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            
            switch(currentView) {
                case 'day':
                    headerText = `${dayNames[currentDate.getDay()]}, ${monthNames[month]} ${currentDate.getDate()}, ${year}`;
                    break;
                case 'threeDay':
                    const startDate = new Date(currentDate);
                    const endDate = new Date(currentDate);
                    endDate.setDate(startDate.getDate() + 2);
                    headerText = `${monthNames[startDate.getMonth()]} ${startDate.getDate()} - ${endDate.getDate()}, ${year}`;
                    break;
                case 'week':
                    const weekStart = new Date(currentDate);
                    weekStart.setDate(currentDate.getDate() - currentDate.getDay());
                    const weekEnd = new Date(weekStart);
                    weekEnd.setDate(weekStart.getDate() + 6);
                    headerText = `${monthNames[weekStart.getMonth()]} ${weekStart.getDate()} - ${weekEnd.getDate()}, ${year}`;
                    break;
                case 'month':
                default:
                    headerText = `${monthNames[month]} ${year}`;
                    break;
            }
            
            document.getElementById('currentPeriod').textContent = headerText;
        }
        
        function renderCalendar() {
            updatePeriodHeader();
            
            const calendarDays = document.getElementById('calendarDays');
            const daysHeader = document.getElementById('daysHeader');
            
            // Clear calendar
            calendarDays.innerHTML = '';
            
            switch(currentView) {
                case 'day':
                    renderDayView();
                    break;
                case 'threeDay':
                    renderThreeDayView();
                    break;
                case 'week':
                    renderWeekView();
                    break;
                case 'month':
                default:
                    renderMonthView();
                    break;
            }
            
            updateUpcomingEvents();
        }
        
        function renderMonthView() {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            const today = new Date();
            
            // Update header for month view
            const daysHeader = document.getElementById('daysHeader');
            daysHeader.style.display = 'grid';
            daysHeader.style.gridTemplateColumns = 'repeat(7, 1fr)';
            
            const calendarDays = document.getElementById('calendarDays');
            calendarDays.style.display = 'grid';
            calendarDays.style.gridTemplateColumns = 'repeat(7, 1fr)';
            
            // Get first day of month and number of days
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            
            // Add empty cells for days before month starts
            for (let i = 0; i < firstDay; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.style.cssText = 'background: var(--bg-secondary); padding: 1rem; min-height: 80px;';
                calendarDays.appendChild(emptyDay);
            }
            
            // Add days of month
            for (let day = 1; day <= daysInMonth; day++) {
                const dayElement = document.createElement('div');
                const currentDayDate = new Date(year, month, day);
                const isToday = today.getFullYear() === year && 
                               today.getMonth() === month && 
                               today.getDate() === day;
                
                const dayEvents = getEventsForDate(currentDayDate);
                
                dayElement.style.cssText = `
                    background: var(--bg-secondary);
                    padding: 0.5rem;
                    min-height: 80px;
                    cursor: pointer;
                    transition: all 0.2s ease;
                    position: relative;
                    display: flex;
                    flex-direction: column;
                    ${isToday ? 'background: #3b82f6; color: white; font-weight: 600;' : ''}
                `;
                
                let dayContent = `<div style="color: ${isToday ? 'white' : 'var(--text-primary)'}; font-weight: ${isToday ? '600' : '400'}; margin-bottom: 0.25rem;">${day}</div>`;
                
                // Add event indicators
                if (dayEvents.length > 0) {
                    dayContent += '<div style="flex: 1; display: flex; flex-direction: column; gap: 1px;">';
                    dayEvents.slice(0, 3).forEach(event => {
                        const color = categoryColors[event.category] || '#10b981';
                        dayContent += `<div style="background: ${color}; color: white; padding: 1px 4px; border-radius: 2px; font-size: 10px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="${event.title}">${event.title}</div>`;
                    });
                    if (dayEvents.length > 3) {
                        dayContent += `<div style="color: var(--text-tertiary); font-size: 10px;">+${dayEvents.length - 3} more</div>`;
                    }
                    dayContent += '</div>';
                }
                
                dayElement.innerHTML = dayContent;
                
                // Add click event to open modal with selected date
                dayElement.addEventListener('click', () => {
                    editingEventId = null;
                    document.getElementById('eventForm').reset();
                    selectedDate = currentDayDate;
                    document.getElementById('eventDate').value = currentDayDate.toISOString().split('T')[0];
                    document.getElementById('eventModal').style.display = 'block';
                });
                
                // Add hover effect
                dayElement.addEventListener('mouseenter', () => {
                    if (!isToday) {
                        dayElement.style.background = 'var(--bg-tertiary)';
                    }
                });
                
                dayElement.addEventListener('mouseleave', () => {
                    if (!isToday) {
                        dayElement.style.background = 'var(--bg-secondary)';
                    }
                });
                
                calendarDays.appendChild(dayElement);
            }
        }
        
        function renderDayView() {
            const daysHeader = document.getElementById('daysHeader');
            const calendarDays = document.getElementById('calendarDays');
            
            // Hide day names header for day view
            daysHeader.style.display = 'none';
            
            // Create single day column
            calendarDays.style.display = 'block';
            
            const dayEvents = getEventsForDate(currentDate);
            const dayName = currentDate.toLocaleDateString('en-US', { weekday: 'long' });
            
            let dayContent = `
                <div style="background: var(--bg-secondary); border-radius: 8px; padding: 2rem; min-height: 400px; max-width: 700px; margin: 0 auto;">
                    <h3 style="color: var(--text-primary); margin-bottom: 1.5rem; text-align: center;">${dayName}</h3>
                    <div style="display: flex; flex-direction: column; gap: 0.75rem;">
            `;
            
            if (dayEvents.length > 0) {
                dayEvents.forEach(event => {
                    const color = categoryColors[event.category] || '#10b981';
                    const timeStr = event.time ? new Date(`2000-01-01T${event.time}`).toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit', hour12: true }) : '';
                    const completedStyle = event.completed ? 'text-decoration: line-through; opacity: 0.7;' : '';
                    dayContent += `
                        <div onclick="editEvent(${event.id})" style="background: var(--bg-primary); border-radius: 8px; padding: 0.75rem 1rem; border-left: 4px solid ${color}; display: flex; align-items: center; justify-content: space-between; gap: 0.75rem; cursor: pointer;">
                            <div style="flex: 1; ${completedStyle}">
                                <div style="font-weight: 600; margin-bottom: 0.1rem; color: var(--text-primary);">
                                    ${event.title}
                                    ${timeStr ? `<span style="font-weight: 500; color: var(--text-secondary); font-size: 0.9rem;"> • ${timeStr}</span>` : ''}
                                </div>
                                ${event.description ? `<div style="font-size: 0.9rem; color: var(--text-secondary);">${event.description}</div>` : ''}
                            </div>
                            <div style="font-size: 0.75rem; color: var(--text-tertiary); white-space: nowrap;">Click to edit</div>
                        </div>
                    `;
                });
            } else {
                dayContent += '<div style="text-align: center; color: var(--text-tertiary); padding: 2rem;">No events scheduled</div>';
            }
            
            dayContent += `
                    </div>
                    <button onclick="editingEventId = null; document.getElementById('eventForm').reset(); selectedDate = currentDate; document.getElementById('eventDate').value = currentDate.toISOString().split('T')[0]; document.getElementById('eventModal').style.display = 'block';" 
                            style="background: #10b981; color: white; border: none; border-radius: 6px; padding: 0.75rem 1.5rem; margin-top: 1.5rem; cursor: pointer; width: 100%;">
                        Add Event for This Day
                    </button>
                </div>
            `;
            
            calendarDays.innerHTML = dayContent;
        }
        
        function renderThreeDayView() {
            const daysHeader = document.getElementById('daysHeader');
            const calendarDays = document.getElementById('calendarDays');
            
            // Update header for 3-day view
            daysHeader.style.display = 'grid';
            daysHeader.style.gridTemplateColumns = 'repeat(3, 1fr)';
            daysHeader.innerHTML = '';
            
            calendarDays.style.display = 'grid';
            calendarDays.style.gridTemplateColumns = 'repeat(3, 1fr)';
            
            for (let i = 0; i < 3; i++) {
                const date = new Date(currentDate);
                date.setDate(currentDate.getDate() + i);
                
                const dayName = date.toLocaleDateString('en-US', { weekday: 'short' });
                const dayNum = date.getDate();
                
                // Add header
                const headerDiv = document.createElement('div');
                headerDiv.style.cssText = 'padding: 1rem; text-align: center; font-weight: 600; color: var(--text-secondary);';
                headerDiv.innerHTML = `${dayName} ${dayNum}`;
                daysHeader.appendChild(headerDiv);
                
                // Add day column
                const dayColumn = document.createElement('div');
                const dayEvents = getEventsForDate(date);
                const isToday = date.toDateString() === new Date().toDateString();
                
                dayColumn.style.cssText = `
                    background: var(--bg-secondary);
                    padding: 1rem;
                    min-height: 300px;
                    cursor: pointer;
                    transition: all 0.2s ease;
                    display: flex;
                    flex-direction: column;
                    gap: 0.5rem;
                    ${isToday ? 'background: #3b82f6; color: white;' : ''}
                `;
                
                if (dayEvents.length > 0) {
                    dayEvents.forEach(event => {
                        const color = categoryColors[event.category] || '#10b981';
                        const eventDiv = document.createElement('div');
                        eventDiv.style.cssText = `background: ${color}; color: white; padding: 0.5rem; border-radius: 4px; font-size: 12px;`;
                        eventDiv.textContent = event.title;
                        dayColumn.appendChild(eventDiv);
                    });
                }
                
                dayColumn.addEventListener('click', () => {
                    editingEventId = null;
                    document.getElementById('eventForm').reset();
                    selectedDate = date;
                    document.getElementById('eventDate').value = date.toISOString().split('T')[0];
                    document.getElementById('eventModal').style.display = 'block';
                });
                
                calendarDays.appendChild(dayColumn);
            }
        }
        
        function renderWeekView() {
            const daysHeader = document.getElementById('daysHeader');
            const calendarDays = document.getElementById('calendarDays');
            
            // Show full week header
            daysHeader.style.display = 'grid';
            daysHeader.style.gridTemplateColumns = 'repeat(7, 1fr)';
            daysHeader.innerHTML = `
                <div style="padding: 1rem; text-align: center; font-weight: 600; color: var(--text-secondary);">Sun</div>
                <div style="padding: 1rem; text-align: center; font-weight: 600; color: var(--text-secondary);">Mon</div>
                <div style="padding: 1rem; text-align: center; font-weight: 600; color: var(--text-secondary);">Tue</div>
                <div style="padding: 1rem; text-align: center; font-weight: 600; color: var(--text-secondary);">Wed</div>
                <div style="padding: 1rem; text-align: center; font-weight: 600; color: var(--text-secondary);">Thu</div>
                <div style="padding: 1rem; text-align: center; font-weight: 600; color: var(--text-secondary);">Fri</div>
                <div style="padding: 1rem; text-align: center; font-weight: 600; color: var(--text-secondary);">Sat</div>
            `;
            
            calendarDays.style.display = 'grid';
            calendarDays.style.gridTemplateColumns = 'repeat(7, 1fr)';
            
            // Get start of week (Sunday)
            const weekStart = new Date(currentDate);
            weekStart.setDate(currentDate.getDate() - currentDate.getDay());
            
            for (let i = 0; i < 7; i++) {
                const date = new Date(weekStart);
                date.setDate(weekStart.getDate() + i);
                
                const dayElement = document.createElement('div');
                const dayEvents = getEventsForDate(date);
                const isToday = date.toDateString() === new Date().toDateString();
                
                dayElement.style.cssText = `
                    background: var(--bg-secondary);
                    padding: 1rem;
                    min-height: 200px;
                    cursor: pointer;
                    transition: all 0.2s ease;
                    display: flex;
                    flex-direction: column;
                    ${isToday ? 'background: #3b82f6; color: white; font-weight: 600;' : ''}
                `;
                
                let dayContent = `<div style="color: ${isToday ? 'white' : 'var(--text-primary)'}; font-weight: ${isToday ? '600' : '400'}; margin-bottom: 0.5rem; text-align: center;">${date.getDate()}</div>`;
                
                if (dayEvents.length > 0) {
                    dayContent += '<div style="flex: 1; display: flex; flex-direction: column; gap: 2px;">';
                    dayEvents.slice(0, 4).forEach(event => {
                        const color = categoryColors[event.category] || '#10b981';
                        dayContent += `<div style="background: ${color}; color: white; padding: 2px 4px; border-radius: 2px; font-size: 10px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="${event.title}">${event.title}</div>`;
                    });
                    if (dayEvents.length > 4) {
                        dayContent += `<div style="color: var(--text-tertiary); font-size: 10px; text-align: center;">+${dayEvents.length - 4} more</div>`;
                    }
                    dayContent += '</div>';
                }
                
                dayElement.innerHTML = dayContent;
                
                dayElement.addEventListener('click', () => {
                    editingEventId = null;
                    document.getElementById('eventForm').reset();
                    selectedDate = date;
                    document.getElementById('eventDate').value = date.toISOString().split('T')[0];
                    document.getElementById('eventModal').style.display = 'block';
                });
                
                calendarDays.appendChild(dayElement);
            }
        }
        
        function updateUpcomingEvents() {
            const upcomingEventsList = document.getElementById('upcomingEventsList');
            upcomingEventsList.innerHTML = '';
            
            // Static events (existing school events)
            const staticEvents = [
                { title: 'Math Test - Chapter 5', date: '2024-12-12', description: 'Algebra and Geometry • Room 204 • 9:00 AM', category: 'test' },
                { title: 'Science Fair', date: '2024-12-15', description: 'Project presentations • School Gymnasium • 2:00 PM', category: 'event' },
                { title: 'Winter Concert', date: '2024-12-20', description: 'School choir performance • Auditorium • 7:00 PM', category: 'event' },
                { title: 'Winter Break Begins', date: '2024-12-21', description: 'Last day of classes • School ends at 12:00 PM', category: 'other' }
            ];
            
            // Combine static events with user events
            const allEvents = [...staticEvents, ...events];
            
            // Filter and sort upcoming events (next 30 days)
            const today = new Date();
            const thirtyDaysFromNow = new Date();
            thirtyDaysFromNow.setDate(today.getDate() + 30);
            
            const upcomingEvents = allEvents
                .filter(event => {
                    const eventDate = new Date(event.date);
                    return eventDate >= today && eventDate <= thirtyDaysFromNow;
                })
                .sort((a, b) => new Date(a.date) - new Date(b.date))
                .slice(0, 6); // Show max 6 events
            
            if (upcomingEvents.length === 0) {
                upcomingEventsList.innerHTML = '<p style="color: var(--text-tertiary); text-align: center; margin: 2rem 0;">No upcoming events</p>';
                return;
            }
            
            upcomingEvents.forEach(event => {
                const eventDate = new Date(event.date);
                const dateStr = eventDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
                const color = categoryColors[event.category] || '#10b981';
                
                const eventElement = document.createElement('div');
                eventElement.style.cssText = `padding: 1rem; background: var(--bg-secondary); border-radius: 8px; border-left: 4px solid ${color};`;
                
                let timeInfo = '';
                if (event.time) {
                    const time = new Date(`2000-01-01T${event.time}`).toLocaleTimeString('en-US', { 
                        hour: 'numeric', 
                        minute: '2-digit', 
                        hour12: true 
                    });
                    timeInfo = ` • ${time}`;
                }
                
                eventElement.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 0.5rem;">
                        <h4 style="margin: 0; color: var(--text-primary);">${event.title}</h4>
                        <span style="background: ${color}; color: white; padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 12px;">${dateStr}</span>
                    </div>
                    <p style="margin: 0; color: var(--text-tertiary); font-size: 14px;">${event.description || 'No description'}${timeInfo}</p>
                `;
                
                upcomingEventsList.appendChild(eventElement);
            });
        }
        
        function findEventById(id) {
            return events.find(event => event.id === id);
        }
        
        function editEvent(id) {
            const event = findEventById(id);
            if (!event) return;
            
            editingEventId = id;
            selectedDate = new Date(event.date);
            
            document.getElementById('eventTitle').value = event.title;
            document.getElementById('eventDate').value = event.date;
            document.getElementById('eventTime').value = event.time || '';
            document.getElementById('eventDescription').value = event.description || '';
            document.getElementById('eventCategory').value = event.category || 'other';
            document.getElementById('eventCompleted').checked = !!event.completed;
            document.getElementById('deleteEventBtn').style.display = 'inline-flex';
            
            document.getElementById('eventModal').style.display = 'block';
        }
        
        function toggleEventComplete(id) {
            const event = findEventById(id);
            if (!event) return;
            
            event.completed = !event.completed;
            saveEvents();
            renderCalendar();
        }
        
        function deleteEvent(id) {
            events = events.filter(event => event.id !== id);
            if (editingEventId === id) {
                editingEventId = null;
            }
            saveEvents();
            renderCalendar();
        }
        
        // Modal functionality
        document.getElementById('addEventBtn').addEventListener('click', () => {
            editingEventId = null;
            document.getElementById('eventForm').reset();
            document.getElementById('eventCompleted').checked = false;
            document.getElementById('deleteEventBtn').style.display = 'none';
            const dateToUse = selectedDate || new Date();
            document.getElementById('eventDate').value = dateToUse.toISOString().split('T')[0];
            document.getElementById('eventModal').style.display = 'block';
        });
        
        document.getElementById('closeModal').addEventListener('click', () => {
            document.getElementById('eventModal').style.display = 'none';
            document.getElementById('eventForm').reset();
            document.getElementById('eventCompleted').checked = false;
            document.getElementById('deleteEventBtn').style.display = 'none';
            editingEventId = null;
        });
        
        document.getElementById('cancelEvent').addEventListener('click', () => {
            document.getElementById('eventModal').style.display = 'none';
            document.getElementById('eventForm').reset();
            document.getElementById('eventCompleted').checked = false;
            document.getElementById('deleteEventBtn').style.display = 'none';
            editingEventId = null;
        });
        
        // Close modal when clicking outside
        document.getElementById('eventModal').addEventListener('click', (e) => {
            if (e.target === document.getElementById('eventModal')) {
                document.getElementById('eventModal').style.display = 'none';
                document.getElementById('eventForm').reset();
                document.getElementById('eventCompleted').checked = false;
                document.getElementById('deleteEventBtn').style.display = 'none';
                editingEventId = null;
            }
        });

        document.getElementById('deleteEventBtn').addEventListener('click', () => {
            if (!editingEventId) return;
            deleteEvent(editingEventId);
            document.getElementById('eventModal').style.display = 'none';
            document.getElementById('eventForm').reset();
            document.getElementById('eventCompleted').checked = false;
            document.getElementById('deleteEventBtn').style.display = 'none';
            editingEventId = null;
        });
        
        // Handle form submission
        document.getElementById('eventForm').addEventListener('submit', (e) => {
            e.preventDefault();
            
            const title = document.getElementById('eventTitle').value;
            const date = document.getElementById('eventDate').value;
            const time = document.getElementById('eventTime').value;
            const description = document.getElementById('eventDescription').value;
            const category = document.getElementById('eventCategory').value;
            const completed = document.getElementById('eventCompleted').checked;
            
            if (editingEventId) {
                const index = events.findIndex(event => event.id === editingEventId);
                if (index !== -1) {
                    events[index] = {
                        ...events[index],
                        title,
                        date,
                        time,
                        description,
                        category,
                        completed
                    };
                }
                editingEventId = null;
            } else {
                const newEvent = {
                    id: Date.now(),
                    title,
                    date,
                    time,
                    description,
                    category,
                    completed
                };
                events.push(newEvent);
            }
            saveEvents();
            
            document.getElementById('eventModal').style.display = 'none';
            document.getElementById('eventForm').reset();
            
            renderCalendar();
        });
        
        // View switching functionality
        function setActiveView(view) {
            currentView = view;
            
            // Update button styles
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.style.background = 'transparent';
                btn.style.color = 'var(--text-secondary)';
            });
            
            const activeBtn = document.getElementById(view + 'View');
            if (activeBtn) {
                activeBtn.style.background = '#3b82f6';
                activeBtn.style.color = 'white';
            }
            
            renderCalendar();
        }
        
        // View button event listeners
        document.getElementById('dayView').addEventListener('click', () => setActiveView('day'));
        document.getElementById('threeDayView').addEventListener('click', () => setActiveView('threeDay'));
        document.getElementById('weekView').addEventListener('click', () => setActiveView('week'));
        document.getElementById('monthView').addEventListener('click', () => setActiveView('month'));
        
        // Navigation event listeners
        document.getElementById('prevPeriod').addEventListener('click', () => {
            switch(currentView) {
                case 'day':
                    currentDate.setDate(currentDate.getDate() - 1);
                    break;
                case 'threeDay':
                    currentDate.setDate(currentDate.getDate() - 3);
                    break;
                case 'week':
                    currentDate.setDate(currentDate.getDate() - 7);
                    break;
                case 'month':
                default:
                    currentDate.setMonth(currentDate.getMonth() - 1);
                    break;
            }
            renderCalendar();
        });
        
        document.getElementById('nextPeriod').addEventListener('click', () => {
            switch(currentView) {
                case 'day':
                    currentDate.setDate(currentDate.getDate() + 1);
                    break;
                case 'threeDay':
                    currentDate.setDate(currentDate.getDate() + 3);
                    break;
                case 'week':
                    currentDate.setDate(currentDate.getDate() + 7);
                    break;
                case 'month':
                default:
                    currentDate.setMonth(currentDate.getMonth() + 1);
                    break;
            }
            renderCalendar();
        });
        
        document.getElementById('todayBtn').addEventListener('click', () => {
            currentDate = new Date();
            renderCalendar();
        });
        
        // Clock functionality
        let currentHour = 12;
        let currentMinute = 0;
        let isAM = true;
        let isDragging = false;
        let clockMode = 'hour'; // 'hour' or 'minute'
        let holdTimer = null;
        let dragStartTime = 0;
        
        function updateClockDisplay() {
            const displayHour = currentHour === 0 ? 12 : currentHour > 12 ? currentHour - 12 : currentHour;
            const displayMinute = currentMinute.toString().padStart(2, '0');
            const period = currentHour < 12 ? 'AM' : 'PM';
            
            document.getElementById('timeDisplay').textContent = `${displayHour}:${displayMinute} ${period}`;
            document.getElementById('amPmBtn').textContent = period;
            
            // Update hidden input for form submission
            const timeString = `${currentHour.toString().padStart(2, '0')}:${currentMinute.toString().padStart(2, '0')}`;
            document.getElementById('eventTime').value = timeString;
            
            updateClockHand();
        }
        
        function updateClockHand() {
            const clockHand = document.getElementById('clockHand');
            
            let angle, handLength, color;
            
            if (clockMode === 'hour') {
                angle = ((currentHour % 12) * 30) + (currentMinute * 0.5) - 90;
                handLength = 25;
                color = '#3b82f6';
            } else {
                angle = (currentMinute * 6) - 90;
                handLength = 40;
                color = '#10b981';
            }
            
            // Calculate hand position
            const handX = 70 + Math.cos(angle * Math.PI / 180) * handLength;
            const handY = 70 + Math.sin(angle * Math.PI / 180) * handLength;
            
            clockHand.setAttribute('x2', handX);
            clockHand.setAttribute('y2', handY);
            clockHand.setAttribute('stroke', color);
        }
        
        function getAngleFromClick(event, clockContainer) {
            const rect = clockContainer.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            const x = event.clientX - centerX;
            const y = event.clientY - centerY;
            let angle = Math.atan2(y, x) * 180 / Math.PI + 90;
            if (angle < 0) angle += 360;
            return angle;
        }
        
        function setTimeFromAngle(angle) {
            if (clockMode === 'hour') {
                let newHour = Math.round(angle / 30) % 12;
                if (newHour === 0) newHour = 12;
                
                // Handle AM/PM conversion
                if (currentHour >= 12 && newHour !== 12) {
                    currentHour = newHour + 12;
                } else if (currentHour < 12 && newHour === 12) {
                    currentHour = 0;
                } else if (currentHour >= 12 && newHour === 12) {
                    currentHour = 12;
                } else {
                    currentHour = newHour;
                }
            } else {
                currentMinute = Math.round(angle / 6) % 60;
            }
            updateClockDisplay();
        }
        
        function switchToMinuteMode() {
            clockMode = 'minute';
            updateClockHand();
        }
        
        // Clock event listeners
        document.getElementById('clockContainer').addEventListener('mousedown', (e) => {
            isDragging = true;
            const angle = getAngleFromClick(e, e.currentTarget);
            setTimeFromAngle(angle);
            
            // Clear any existing timer
            if (holdTimer) {
                clearTimeout(holdTimer);
                holdTimer = null;
            }
        });
        
        document.addEventListener('mousemove', (e) => {
            if (isDragging) {
                const clockContainer = document.getElementById('clockContainer');
                const angle = getAngleFromClick(e, clockContainer);
                setTimeFromAngle(angle);
            }
        });
        
        document.addEventListener('mouseup', () => {
            if (isDragging) {
                // After letting go, wait 0.60 seconds then switch to minute mode (if in hour mode)
                if (clockMode === 'hour') {
                    holdTimer = setTimeout(() => {
                        switchToMinuteMode();
                    }, 600);
                }
            }
            
            isDragging = false;
        });
        
        // AM/PM toggle
        document.getElementById('amPmBtn').addEventListener('click', () => {
            if (currentHour === 0) {
                currentHour = 12;
            } else if (currentHour === 12) {
                currentHour = 0;
            } else if (currentHour < 12) {
                currentHour += 12;
            } else {
                currentHour -= 12;
            }
            isAM = !isAM;
            updateClockDisplay();
        });
        
        // Clear time
        document.getElementById('clearTimeBtn').addEventListener('click', () => {
            currentHour = 12;
            currentMinute = 0;
            isAM = true;
            clockMode = 'hour';
            document.getElementById('eventTime').value = '';
            document.getElementById('timeDisplay').textContent = '12:00 PM';
            document.getElementById('amPmBtn').textContent = 'AM';
            updateClockDisplay();
        });
        
        // Initialize clock
        updateClockDisplay();
        
        // Initialize calendar
        renderCalendar();
    </script>
</body>
</html>
